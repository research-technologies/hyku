<!-- copied from https://raw.githubusercontent.com/samvera/hyrax/v2.0.2/app/views/hyrax/notifications/_notifications.html.erb -->

<% if messages.present? %>
  <div class="table-responsive">
    <table class="table table-striped datatable">
      <thead>
        <tr>
          <th><%= t('hyrax.mailbox.date') %></th>
          <th><%= t('hyrax.mailbox.subject') %></th>
          <th><%= t('hyrax.mailbox.message') %></th>
          <th><span class="sr-only"><%= t('hyrax.mailbox.delete') %></span></th>
        </tr>
      </thead>
      <tbody>
        <% messages.each do |msg| %>
          <tr>
            <td data-sort="<%= msg.last_message.created_at.getutc.iso8601(5) %>">
              <relative-time datetime="<%= msg.last_message.created_at.getutc.iso8601 %>" title="<%= msg.last_message.created_at.to_formatted_s(:standard) %>">
                <%= msg.last_message.created_at.to_formatted_s(:long_ordinal) %>
              </relative-time>
            </td>
            <td><%= msg.last_message.subject.try(:html_safe )%></td>
            <% redirect_object = Ubiquity::Api::RedirectWorkIdInWorkflowNotification.new(message: msg, url: request.original_url) %>
            <% if redirect_object.new_url.present?  && redirect_object.point_link_to_frontend.present? %>
              <td> <%= redirect_object.point_link_to_frontend.html_safe %>  </td>
            <% else %>
              <td><%= msg.last_message.body.try(:html_safe) %></td>
            <% end %>
            <td>
              <%= link_to hyrax.notification_path(msg.id),
                      class: "itemicon itemtrash",
                      title: t('hyrax.mailbox.delete'),
                      method: :delete do %>
                  <span class="sr-only"><%= I18n.t('hyrax.dashboard.delete_notification') %></span>
                <i class="glyphicon glyphicon-trash" aria-hidden="true"></i>
                <% end %>
            </td>
          </tr>
          <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <p><%= t('hyrax.mailbox.empty') %></p>
<% end %>
